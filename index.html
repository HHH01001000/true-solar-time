<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1">&lt;meta charset="UTF-8"&gt;</p>
<p class="p1">&lt;title&gt;True Solar Time&lt;/title&gt;</p>
<p class="p1">&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1">&lt;style&gt;</p>
<p class="p1">body { background: #111; color: #eee; font-family: system-ui, sans-serif; text-align: center; padding: 40px; }</p>
<p class="p1">input { font-size:1.2em; padding:6px; margin:6px; width:160px; }</p>
<p class="p1">#time { font-size:2.8em; margin-top:30px; }</p>
<p class="p1">button { font-size:1em; padding:6px 14px; margin-top:10px; }</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;h1&gt;True Solar Time&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div&gt;</p>
<p class="p1">Longitude (° East + / West −):</p>
<p class="p1">&lt;br&gt;&lt;input id="lon" type="number" step="0.0001" value="121.4737"&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div&gt;</p>
<p class="p1">Latitude (° North + / South −):</p>
<p class="p1">&lt;br&gt;&lt;input id="lat" type="number" step="0.0001" value="31.2304"&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;br&gt;</p>
<p class="p1">&lt;button id="autoLoc"&gt;Use My Location&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div id="time"&gt;--:--:--&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">function equationOfTime(date){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const day = Math.floor(</p>
<p class="p1"><span class="Apple-converted-space">    </span>(Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate()) -</p>
<p class="p1"><span class="Apple-converted-space">     </span>Date.UTC(date.getUTCFullYear(), 0, 0)) / 86400000);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const B = (2*Math.PI/365)*(day - 81);</p>
<p class="p1"><span class="Apple-converted-space">  </span>return 9.87*Math.sin(2*B) - 7.53*Math.cos(B) - 1.5*Math.sin(B);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function updateTime(){</p>
<p class="p1"><span class="Apple-converted-space">  </span>const lon = parseFloat(document.getElementById("lon").value) || 0;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const now = new Date();</p>
<p class="p1"><span class="Apple-converted-space">  </span>const utcMinutes = now.getUTCHours()*60 + now.getUTCMinutes() + now.getUTCSeconds()/60;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const solarMinutes = utcMinutes + lon * 4 + equationOfTime(now);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const m = ((solarMinutes % 1440) + 1440) % 1440;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const h = Math.floor(m / 60);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const min = Math.floor(m % 60);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const sec = Math.floor((m % 1) * 60);</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById("time").textContent =</p>
<p class="p1"><span class="Apple-converted-space">    </span>String(h).padStart(2,"0") + ":" +</p>
<p class="p1"><span class="Apple-converted-space">    </span>String(min).padStart(2,"0") + ":" +</p>
<p class="p1"><span class="Apple-converted-space">    </span>String(sec).padStart(2,"0");</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">setInterval(updateTime,1000);</p>
<p class="p1">updateTime();</p>
<p class="p2"><br></p>
<p class="p1">// Auto‑location</p>
<p class="p1">document.getElementById("autoLoc").addEventListener("click",()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">  </span>if(navigator.geolocation){</p>
<p class="p1"><span class="Apple-converted-space">    </span>navigator.geolocation.getCurrentPosition(pos=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById("lon").value = pos.coords.longitude.toFixed(4);</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById("lat").value = pos.coords.latitude.toFixed(4);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}, err =&gt; alert("Location access denied."));</p>
<p class="p1"><span class="Apple-converted-space">  </span>} else alert("Geolocation not supported.");</p>
<p class="p1">});</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
